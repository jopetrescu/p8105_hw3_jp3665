p8105\_hw3\_jp3665
================
Joana Petrescu
12/10/2020

``` r
library(tidyverse)
```

    ## ── Attaching packages ────────────────────────────────────────────────────────── tidyverse 1.3.0 ──

    ## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
    ## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
    ## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
    ## ✓ readr   1.3.1     ✓ forcats 0.5.0

    ## ── Conflicts ───────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(p8105.datasets)
library(janitor)
```

    ## 
    ## Attaching package: 'janitor'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     chisq.test, fisher.test

``` r
library(knitr)
```

## Instacart data

Load and explore data

``` r
data("instacart") %>% tidy_names()
```

    ## [1] "instacart"

``` r
dim(instacart)
```

    ## [1] 1384617      15

The “Instacart” data consist of 1384617 observations for 15 variables.
The variables are as follows:

  - `order_id`: order identifier
  - `product_id`: product identifier
  - `add_to_cart_order`: order in which each product was added to cart
  - `reordered`: 1 if this product has been ordered by this user in the
    past, 0 otherwise
  - `user_id`: customer identifier
  - `order_number`: the order sequence number for this user (1=first,
    n=nth)
  - `order_dow`: the day of the week on which the order was placed
  - `order_hour_of_day`: the hour of the day on which the order was
    placed
  - `days_since_prior_order`: days since the last order, capped at 30,
    NA if order\_number=1
  - `product_name`: name of the product
  - `aisle_id:` aisle identifier
  - `department_id`: department identifier
  - `aisle`: the name of the aisle
  - `department`: the name of the department

Here is a random observation from the data set as an example:

``` r
instacart[61,]
```

    ## # A tibble: 1 x 15
    ##   order_id product_id add_to_cart_ord… reordered user_id eval_set order_number
    ##      <int>      <int>            <int>     <int>   <int> <chr>           <int>
    ## 1       98      24964               29         1   56463 train              41
    ## # … with 8 more variables: order_dow <int>, order_hour_of_day <int>,
    ## #   days_since_prior_order <int>, product_name <chr>, aisle_id <int>,
    ## #   department_id <int>, aisle <chr>, department <chr>

This observation refers to organic garlic (produce department, fresh
vegetables aisle) that was the 29th item to be added to cart on Tuesday
at 8:00 as part of order \#98 by user \#56463. This user has ordered 40
times previously, they placed their previoous order 14 days prior to
this one, and they have ordered this item before.

``` r
instacart %>% count(aisle) %>% nrow()
```

    ## [1] 134

``` r
instacart %>% count(aisle) %>% arrange(desc(n)) %>% head() %>% knitr::kable()
```

| aisle                         |      n |
| :---------------------------- | -----: |
| fresh vegetables              | 150609 |
| fresh fruits                  | 150473 |
| packaged vegetables fruits    |  78493 |
| yogurt                        |  55240 |
| packaged cheese               |  41699 |
| water seltzer sparkling water |  36617 |

There are 134 unique aisles defined in this data set. This table
demonstrates that the most items are ordered from the fresh vegetables
and fresh fruits aisles.

Plot the number of items ordered from each isle for aisles with \>10k
items ordered.

``` r
instacart %>% 
  count(aisle) %>%
  mutate(aisle = fct_reorder(aisle, n)) %>%
  filter(n > 10000) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_bar(stat = "identity") +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  xlab("Aisle") +
  ylab("Number of items") +
  ggtitle("Number of items ordered for each aisle")
```

![](p8105_hw3_jp3665_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

Make a tablee showing the three most popular items in each of the
following: baking ingredients, dog food care, and packaged vegetables
fruits.

``` r
instacart %>%
  select(product_name, aisle) %>%
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  group_by(aisle) %>%
  count(product_name) %>%
  top_n(3) %>%
  knitr::kable()
```

    ## Selecting by n

| aisle                      | product\_name                                 |    n |
| :------------------------- | :-------------------------------------------- | ---: |
| baking ingredients         | Cane Sugar                                    |  336 |
| baking ingredients         | Light Brown Sugar                             |  499 |
| baking ingredients         | Pure Baking Soda                              |  387 |
| dog food care              | Organix Chicken & Brown Rice Recipe           |   28 |
| dog food care              | Small Dog Biscuits                            |   26 |
| dog food care              | Snack Sticks Chicken & Rice Recipe Dog Treats |   30 |
| packaged vegetables fruits | Organic Baby Spinach                          | 9784 |
| packaged vegetables fruits | Organic Blueberries                           | 4966 |
| packaged vegetables fruits | Organic Raspberries                           | 5546 |

Make a table showing the mean hour of the day that Pink Lady Apples and
Coffee Ice Cream are ordered on each day of the week.

``` r
instacart %>%
  select(product_name, order_hour_of_day, order_dow) %>%
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>%
  summarize(mean(order_hour_of_day)) %>%
  spread(order_dow, "mean(order_hour_of_day)") %>%
  rename(
    sunday = "0",
    monday = "1",
    tuesday = "2",
    wednesday = "3",
    thursday = "4",
    friday = "5",
    saturday = "6"
  ) %>%
  knitr::kable()
```

    ## `summarise()` regrouping output by 'product_name' (override with `.groups` argument)

| product\_name    |   sunday |   monday |  tuesday | wednesday | thursday |   friday | saturday |
| :--------------- | -------: | -------: | -------: | --------: | -------: | -------: | -------: |
| Coffee Ice Cream | 13.77419 | 14.31579 | 15.38095 |  15.31818 | 15.21739 | 12.26316 | 13.83333 |
| Pink Lady Apples | 13.44118 | 11.36000 | 11.70213 |  14.25000 | 11.55172 | 12.78431 | 11.93750 |
