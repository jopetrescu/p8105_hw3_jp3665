---
title: "p8105_hw3_jp3665"
author: "Joana Petrescu"
date: "12/10/2020"
output: github_document
---

```{r}

library(tidyverse)
library(p8105.datasets)
library(janitor)
library(knitr)

```

## Instacart data

Load and explore data

```{r}

data("instacart") %>% tidy_names()

dim(instacart)

```

The "Instacart" data consist of 1384617 observations for 15 variables. The variables are as follows:

* `order_id`: order identifier
* `product_id`: product identifier
* `add_to_cart_order`: order in which each product was added to cart
* `reordered`: 1 if this product has been ordered by this user in the past, 0 otherwise
* `user_id`: customer identifier
* `order_number`: the order sequence number for this user (1=first, n=nth)
* `order_dow`: the day of the week on which the order was placed
* `order_hour_of_day`: the hour of the day on which the order was placed
* `days_since_prior_order`: days since the last order, capped at 30, NA if order_number=1
* `product_name`: name of the product
* `aisle_id:` aisle identifier
* `department_id`: department identifier
* `aisle`: the name of the aisle
* `department`: the name of the department

Here is a random observation from the data set as an example:

```{r}

instacart[61,]

```

This observation refers to organic garlic (produce department, fresh vegetables aisle) that was the 29th item to be added to cart on Tuesday at 8:00 as part of order #98 by user #56463. This user has ordered 40 times previously, they placed their previoous order 14 days prior to this one, and they have ordered this item before.

```{r}

instacart %>% count(aisle) %>% nrow()

instacart %>% count(aisle) %>% arrange(desc(n)) %>% head() %>% knitr::kable()

```

There are 134 unique aisles defined in this data set. This table demonstrates that the most items are ordered from the fresh vegetables and fresh fruits aisles.

Plot the number of items ordered from each isle for aisles with >10k items ordered.

```{r}

instacart %>% 
  count(aisle) %>%
  mutate(aisle = fct_reorder(aisle, n)) %>%
  filter(n > 10000) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_bar(stat = "identity") +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  xlab("Aisle") +
  ylab("Number of items") +
  ggtitle("Number of items ordered for each aisle")
  

```

Make a tablee showing the three most popular items in each of the following: baking ingredients, dog food care,  and packaged vegetables fruits.

```{r}

instacart %>%
  select(product_name, aisle) %>%
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  group_by(aisle) %>%
  count(product_name) %>%
  top_n(3) %>%
  knitr::kable()

```


Make a table showing the mean hour of the day that Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week.

```{r}

instacart %>%
  select(product_name, order_hour_of_day, order_dow) %>%
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>%
  summarize(mean(order_hour_of_day)) %>%
  spread(order_dow, "mean(order_hour_of_day)") %>%
  rename(
    sunday = "0",
    monday = "1",
    tuesday = "2",
    wednesday = "3",
    thursday = "4",
    friday = "5",
    saturday = "6"
  ) %>%
  knitr::kable()

```

